#!/bin/bash
set -e

echo "Updating systemd services for mise..."

# This script should be run on the production server as root or with sudo

# Copy service files
sudo cp /home/wortschule/app/current/systemd/wortschule.service /etc/systemd/system/
sudo cp /home/wortschule/app/current/systemd/wortschule-jobs.service /etc/systemd/system/

# Reload systemd daemon
sudo systemctl daemon-reload

# Restart services
sudo systemctl restart wortschule
sudo systemctl restart wortschule-jobs

# Check status
echo ""
echo "Service status:"
sudo systemctl status wortschule --no-pager
echo ""
sudo systemctl status wortschule-jobs --no-pager

echo ""
echo "Services updated successfully!"