- set_meta_tags title: t('.page_title')

%h1.text-3xl.font-bold.mb-6= t('.title')

= box do
  .mb-6
    %h2.text-xl.font-semibold.mb-4= t('.overview')
    .grid.grid-cols-1.md:grid-cols-3.gap-4
      .bg-blue-50.p-4.rounded-lg
        %p.text-sm.text-gray-600= t('.total_records')
        %p.text-2xl.font-bold.text-blue-600= number_with_delimiter(@total_records)
      .bg-green-50.p-4.rounded-lg
        %p.text-sm.text-gray-600= t('.overall_success_rate')
        %p.text-2xl.font-bold.text-green-600= "#{@overall_success_rate}%"
      .bg-yellow-50.p-4.rounded-lg
        %p.text-sm.text-gray-600= t('.problematic_words')
        %p.text-2xl.font-bold.text-yellow-600= @problematic_words.count

- if @problematic_words.empty?
  = box do
    %p.text-center.text-gray-600= t('.no_data')
- else
  = box do
    %h2.text-xl.font-semibold.mb-4= t('.problematic_words_title')
    %p.text-sm.text-gray-600.mb-4= t('.problematic_words_description')

    .overflow-x-auto
      %table.w-full.text-sm
        %thead
          %tr.border-b.border-gray-300
            %th.px-4.py-3.text-left.font-semibold= t('.word')
            %th.px-4.py-3.text-left.font-semibold= t('.word_type')
            %th.px-4.py-3.text-right.font-semibold= t('.total_attempts')
            %th.px-4.py-3.text-right.font-semibold= t('.correct')
            %th.px-4.py-3.text-right.font-semibold= t('.failures')
            %th.px-4.py-3.text-right.font-semibold= t('.failure_rate')
            %th.px-4.py-3.text-right.font-semibold= t('.actions')

        %tbody
          - @problematic_words.each do |row|
            - next unless row[:word]
            %tr.border-b.border-gray-100.hover:bg-gray-50
              %td.px-4.py-3
                = link_to row[:word].name, row[:word], class: 'text-blue-600 hover:text-blue-900 font-medium'
              %td.px-4.py-3
                %span.text-xs.bg-blue-100.text-blue-800.px-2.py-1.rounded
                  = row[:word].class.model_name.human
              %td.px-4.py-3.text-right= row[:total_attempts]
              %td.px-4.py-3.text-right.text-green-600= row[:correct_count]
              %td.px-4.py-3.text-right.text-red-600= row[:failures]
              %td.px-4.py-3.text-right
                - rate = row[:failure_rate].to_f
                %span{ class: rate >= 50 ? 'text-red-600 font-bold' : 'text-yellow-600' }
                  = "#{rate}%"
              %td.px-4.py-3.text-right
                = link_to t('.details'), keyword_analytic_path(row[:word]), class: 'button button-sm primary'
